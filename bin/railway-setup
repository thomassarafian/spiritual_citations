#!/bin/bash -e

echo "ğŸš‚ Railway.app Database Setup"
echo "=============================="

# Wait for database to be available
echo "â³ Waiting for database to be available..."
until pg_isready -h $DATABASE_HOST -p $DATABASE_PORT -U $DATABASE_USER; do
  echo "Database is unavailable - sleeping"
  sleep 2
done

echo "âœ… Database is available!"

# Create database if it doesn't exist
echo "ğŸ”§ Setting up database..."
./bin/rails db:create || echo "Database might already exist"
./bin/rails db:migrate
./bin/rails db:seed || echo "Seeds might already exist"

echo "ğŸ‰ Database setup complete!"
